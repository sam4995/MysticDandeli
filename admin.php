<?php require __DIR__.'/config.php'; require __DIR__.'/db.php'; session_start(); if(isset($_POST['u'],$_POST['p'])){ if($_POST['u']===$ADMIN_USER && $_POST['p']===$ADMIN_PASS) $_SESSION['ok']=1; } if(isset($_GET['logout'])){ session_destroy(); header('Location: admin.php'); exit; } if(empty($_SESSION['ok'])): ?>
<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet'><title>Admin Login</title></head><body class='container py-5'><h1>Admin</h1><form method='post' class='col-md-4'><div class='mb-3'><label class='form-label'>User</label><input name='u' class='form-control'></div><div class='mb-3'><label class='form-label'>Pass</label><input type='password' name='p' class='form-control'></div><button class='btn btn-brand'>Login</button></form></body></html><?php exit; endif; $db=db(); $bookings=$db->query("SELECT * FROM bookings ORDER BY created_at DESC")->fetchAll(PDO::FETCH_ASSOC); $messages=$db->query("SELECT * FROM messages ORDER BY created_at DESC")->fetchAll(PDO::FETCH_ASSOC); ?>
<!doctype html><html lang='en'><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet'><title>Dashboard</title></head><body class='container-fluid py-4'><div class='d-flex justify-content-between align-items-center mb-3'><h1>Dashboard</h1><a href='?logout=1' class='btn btn-outline-danger'>Logout</a></div><h3>Bookings</h3><div class='table-responsive'><table class='table table-sm table-striped'><thead><tr><th>ID</th><th>Type</th><th>Ref</th><th>People</th><th>Name</th><th>Email</th><th>Phone</th><th>Dates</th><th>Created</th></tr></thead><tbody><?php foreach($bookings as $b):?><tr><td><?=$b['id']?></td><td><?=$b['type']?></td><td><?=$b['ref_id']?></td><td><?=$b['people']?></td><td><?=clean($b['name'])?></td><td><?=clean($b['email'])?></td><td><?=clean($b['phone'])?></td><td><?php if($b['type']==='resort'):?><?=clean($b['checkin'])?> â†’ <?=clean($b['checkout'])?><?php else:?><?=clean($b['activity_date'])?><?php endif;?></td><td><?=$b['created_at']?></td></tr><?php endforeach;?></tbody></table></div><h3 class='mt-5'>Messages</h3><div class='table-responsive'><table class='table table-sm table-striped'><thead><tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th><th>Subject</th><th>Message</th><th>Created</th></tr></thead><tbody><?php foreach($messages as $m):?><tr><td><?=$m['id']?></td><td><?=clean($m['name'])?></td><td><?=clean($m['email'])?></td><td><?=clean($m['phone'])?></td><td><?=clean($m['subject'])?></td><td><?=nl2br(clean($m['message']))?></td><td><?=$m['created_at']?></td></tr><?php endforeach;?></tbody></table></div></body></html>